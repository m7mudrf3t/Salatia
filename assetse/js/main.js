let allCountry = {
  country: [
    {
      id: 1,
      ISO: "EG",
      img: "assetse/images/flag/egypt.svg",
      name: {
        en: "Egypt",
        ar: "مصر",
      },
    },
    {
      id: 2,
      ISO: "SA",
      img: "assetse/images/flag/saudi-arabia.svg",
      name: {
        en: "Saudi Arabia",
        ar: "السعودية",
      },
    },
    {
      id: 3,
      ISO: "AE",
      img: "assetse/images/flag/united-arab-emirates.svg",
      name: {
        en: "United Arab Emirates",
        ar: "الإمارات",
      },
    },
    {
      id: 4,
      ISO: "KW",
      img: "assetse/images/flag/kuwait.svg",
      name: {
        en: "Kuwait",
        ar: "الكويت",
      },
    },
    {
      id: 5,
      ISO: "TR",
      img: "assetse/images/flag/turkey.svg",
      name: {
        en: "Türkiye",
        ar: "تركيا",
      },
    },
    {
      id: 6,
      ISO: "DZ",
      img: "assetse/images/flag/algeria.svg",
      name: {
        en: "Algeria",
        ar: "الجزائر",
      },
    },
    {
      id: 7,
      ISO: "MA",
      img: "assetse/images/flag/morocco.svg",
      name: {
        en: "Morocco",
        ar: "المغرب",
      },
    },
    {
      id: 8,
      ISO: "IQ",
      img: "assetse/images/flag/iraq.svg",
      name: {
        en: "Iraq",
        ar: "العراق",
      },
    },
  ],
  city: [
    {
      cityID: 1,
      ISO: "EG",
      en: "Ad Daqahlīyah",
      ar: "الدقهلية",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Al Baḩr al Aḩmar",
      ar: "البحر الأحمر",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Al Buḩayrah",
      ar: "البحيرة",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Al Fayyūm",
      ar: "الفيوم",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Al Gharbīyah",
      ar: "الغربية",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Al Iskandarīyah",
      ar: "الإسكندرية",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Al Ismā'īlīyah",
      ar: "الإسماعيلية",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Al Jīzah",
      ar: "الجيزه",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Al Minyā",
      ar: "المنيا",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Al Minūfīyah",
      ar: "المنوفية",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Al Qalyūbīyah",
      ar: "القليوبية",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Al Qāhirah",
      ar: "القاهره",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Al Uqşur",
      ar: "الاقصر",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Al Wādī al Jadīd",
      ar: "الوادي الجديد",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "As Suways",
      ar: "السويس",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Ash Sharqīyah",
      ar: "الشرقية",
    },

    {
      cityID: 1,
      ISO: "EG",
      en: "Aswān",
      ar: "أسوان",
    },
    {
      cityID: 1,
      ISO: "EG",
      en: "Asyūţ",
      ar: "أسيوط",
    },
    {
      cityID: 1,
      ISO: "EG",
      ar: "بني سويف",
      en: "Banī Suwayf",
    },
    {
      cityID: 1,
      ISO: "EG",
      ar: "بورسعيد",
      en: "Būr Sa‘īd",
    },
    {
      cityID: 1,
      ISO: "EG",
      ar: "دمياط",
      en: "Dumyāţ",
    },

    {
      cityID: 1,
      ISO: "EG",
      ar: "جانوب سينا",
      en: "Janūb Sīnā'",
    },
    {
      cityID: 1,
      ISO: "EG",
      ar: "كفر الشيخ",
      en: "Kafr ash Shaykh",
    },
    {
      cityID: 1,
      ISO: "EG",
      ar: "مطروح",
      en: "Maţrūḩ",
    },
    {
      cityID: 1,
      ISO: "EG",
      ar: "قنا",
      en: "Qinā",
    },
    {
      cityID: 1,
      ISO: "EG",
      ar: "شمال سيناء",
      en: "Shamāl Sīnā'",
    },
    {
      cityID: 1,
      ISO: "EG",
      ar: "سوهاج",
      en: "Sohag",
    },
    {
      cityID: 2,
      ISO: "SA",
      en: "Asir",
      ar: "عسير",
    },
    {
      cityID: 2,
      ISO: "SA",
      en: "Al Bahah",
      ar: "الباحة",
    },
    {
      cityID: 2,
      ISO: "SA",
      en: "Al Jawf",
      ar: "الجوف",
    },
    {
      cityID: 2,
      ISO: "SA",
      en: "Al Madinah al Munawwarah",
      ar: "المدينة المنورة",
    },
    {
      cityID: 2,
      ISO: "SA",
      en: "Al Qasim",
      ar: "القصيم",
    },
    {
      cityID: 2,
      ISO: "SA",
      en: "Al Hudud ash Shamaliyah",
      ar: "الحدود الشمالية",
    },
    {
      cityID: 2,
      ISO: "SA",
      en: "Ar Riyad",
      ar: "الرياض",
    },
    {
      cityID: 2,
      ISO: "SA",
      en: "Jazan",
      ar: "جازان",
    },
    {
      cityID: 2,
      ISO: "SA",
      en: "Makkah al Mukarramah",
      ar: "مكة المكرمة",
    },
    {
      cityID: 2,
      ISO: "SA",
      en: "Najran",
      ar: "نجران",
    },
    {
      cityID: 2,
      ISO: "SA",
      en: "Tabuk",
      ar: "تبوك",
    },
    {
      cityID: 2,
      ISO: "SA",
      en: "Hail",
      ar: "حائل",
    },
    {
      cityID: 3,
      ISO: "AE",
      en: "Dubai",
      ar: "دبي",
    },
    {
      cityID: 3,
      ISO: "AE",
      en: "Abu Dhabi",
      ar: "أبوظبي",
    },
    {
      cityID: 3,
      ISO: "AE",
      en: "Sharjah",
      ar: "الشارقة",
    },
    {
      cityID: 3,
      ISO: "AE",
      en: "Ajman",
      ar: "عجمان",
    },
    {
      cityID: 3,
      ISO: "AE",
      en: "Umm Al Quwain",
      ar: "أم القيوين",
    },
    {
      cityID: 3,
      ISO: "AE",
      en: "Ras Al Khaimah",
      ar: "رأس الخيمة",
    },
    {
      cityID: 3,
      ISO: "AE",
      en: "Fujairah",
      ar: "الفجيرة",
    },
    {
      cityID: 3,
      ISO: "AE",
      en: "Al Ain",
      ar: "العين",
    },
    {
      cityID: 4,
      ISO: "KW",
      en: "Kuwait City",
      ar: "مدينة الكويت",
    },
    {
      cityID: 4,
      ISO: "KW",
      en: "Hawalli",
      ar: "حولي",
    },
    {
      cityID: 4,
      ISO: "KW",
      en: "Ahmadi",
      ar: "الأحمدي",
    },
    {
      cityID: 4,
      ISO: "KW",
      en: "Farwaniya",
      ar: "الفروانية",
    },
    {
      cityID: 4,
      ISO: "KW",
      en: "Jahra",
      ar: "الجهراء",
    },
    {
      cityID: 4,
      ISO: "KW",
      en: "Mubarak Al-Kabeer",
      ar: "مبارك الكبير",
    },
    {
      cityID: 4,
      ISO: "KW",
      en: "Sabah Al-Salem",
      ar: "صباح السالم",
    },
    {
      cityID: 5,
      ISO: "TR",
      en: "Istanbul",
      ar: "إسطنبول",
    },
    {
      cityID: 5,
      ISO: "TR",
      en: "Ankara",
      ar: "أنقرة",
    },
    {
      cityID: 5,
      ISO: "TR",
      en: "Izmir",
      ar: "إزمير",
    },
    {
      cityID: 5,
      ISO: "TR",
      en: "Bursa",
      ar: "بروصة",
    },
    {
      cityID: 5,
      ISO: "TR",
      en: "Antalya",
      ar: "أنطاليا",
    },
    {
      cityID: 5,
      ISO: "TR",
      en: "Adana",
      ar: "أضنة",
    },

    {
      cityID: 6,
      ISO: "DZ",
      en: "Adrar",
      ar: "أدرار",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "El Meghaier",
      ar: "المغير",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Annaba",
      ar: "عنابة",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Aïn Defla",
      ar: "عين الدفلة",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "El Bayadh",
      ar: "البيض",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Batna",
      ar: "باتنة",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Biskra",
      ar: "عين الدفلة",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Blida",
      ar: "البليدة",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Bordj Badji Mokhtar",
      ar: "برج باجي مختار",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Bordj Bou Arréridj",
      ar: "برج بوعريريج",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Bouira",
      ar: "البويرة",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Boumerdès",
      ar: "البويرة",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Béchar",
      ar: "بشار",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Béjaïa",
      ar: "بجاية",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Djelfa",
      ar: "الجلفة",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Chlef",
      ar: "الشلف",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Djanet",
      ar: "جانت",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "El Meniaa",
      ar: "المنيا",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "El Oued",
      ar: "الطارف",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "El Tarf",
      ar: "الطارف",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Ghardaïa",
      ar: "غرداية",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Guelma",
      ar: "قالمة",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Illizi",
      ar: "إليزي",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "In Guezzam",
      ar: "في قزام",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "In Salah",
      ar: "عين صلاح",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Jijel",
      ar: "جيجل",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Khenchela",
      ar: "خنشلة",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Laghouat",
      ar: "الأغواط",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "M'sila",
      ar: "المسيلة",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Mascara",
      ar: "الماسكارا",
    },
    {
      cityID: 6,
      ISO: "DZ",
      en: "Mila",
      ar: "ميلا",
    },
    {
      en: "Casablanca",
      ar: "الدار البيضاء",
      cityID: 7,
      ISO: "MA",
    },
    {
      en: "Rabat",
      ar: "الرباط",
      cityID: 7,
      ISO: "MA",
    },
    {
      en: "Fes",
      ar: "فاس",
      cityID: 7,
      ISO: "MA",
    },
    {
      en: "Marrakesh",
      ar: "مراكش",
      cityID: 7,
      ISO: "MA",
    },
    {
      en: "Tangier",
      ar: "طنجة",
      cityID: 7,
      ISO: "MA",
    },
    {
      en: "Agadir",
      ar: "أغادير",
      cityID: 7,
      ISO: "MA",
    },
    {
      en: "Meknes",
      ar: "مكناس",
      cityID: 7,
      ISO: "MA",
    },
    {
      en: "Oujda",
      ar: "وجدة",
      cityID: 7,
      ISO: "MA",
    },
    {
      en: "Kenitra",
      ar: "القنيطرة",
      cityID: 7,
      ISO: "MA",
    },
    {
      en: "Tetouan",
      ar: "تطوان",
      cityID: 7,
      ISO: "MA",
    },
  ],
};

//  api
function getPrayTiming(cityName, countryISO) {
  //  calling pray timing api
   let params = {
    // country: "EG",
    country: countryISO,
    city: cityName, //"Ad Daqahliyah",
  };
  // Optionally the request above could also be done as
  axios
    .get("https://api.aladhan.com/v1/timingsByCity", {
      params: params,
    })
    .then(function (response) {
       let timing = response.data.data.timings;
      document.getElementById("Fajr").innerHTML = timing.Fajr;
      document.getElementById("Sunrise").innerHTML = timing.Sunrise;
      document.getElementById("Dhuhr").innerHTML = timing.Dhuhr;
      document.getElementById("Asr").innerHTML = timing.Asr;
      document.getElementById("Maghrib").innerHTML = timing.Maghrib;
      document.getElementById("Isha").innerHTML = timing.Isha;

      let dayCalendar = response.data.data.date.readable;
      document.getElementById("daycalendar").innerHTML = dayCalendar;
      let weekCalendar = response.data.data.date.hijri.weekday.ar;
      document.getElementById("weekcalendar").innerHTML = weekCalendar;
      let timeZone = response.data.data.meta.timezone;
      document.getElementById("time-zone").innerHTML = timeZone;

      displayRemainingTime(response);
    })
    .catch(function (error) {
      console.log(error);
    })
    .finally(function () {
      // always executed
    });
}

getPrayTiming("Cairo", "EG");

// clock function
function displayTime() {
  const ndata = new Date();
  const currentHour = ndata.getHours();
  const currentMinute = ndata.getMinutes();
  const currentSecond = ndata.getSeconds();
  const time = `${currentHour}:${currentMinute}:${currentSecond}`;
  document.getElementById("live-clock").textContent = time;
}
setInterval(displayTime, 1000);

function displayRemainingTime(response) {
  let prayerTimes = response.data.data.timings;

  for (let prayer in prayerTimes) {
    let [hours, minutes] = prayerTimes[prayer].split(":");
    prayerTimes[prayer] = {
      hours: parseInt(hours),
      minutes: parseInt(minutes),
    };

    let now = new Date();
    let prayerDate = new Date(); // create a new date object for the prayer time
     prayerDate.setHours(prayerTimes[prayer].hours); // set the prayer hour

    prayerDate.setMinutes(prayerTimes[prayer].minutes); // set the prayer minute

    prayerDate.setSeconds(0); // set the seconds to 0
    let diff = prayerDate - now; // calculate the time difference in milliseconds
     let vminutes = Math.floor((diff / (1000 * 60)) % 60); // get the remaining minutes
    let vhours = Math.floor((diff / (1000 * 60 * 60)) % 24); // get the remaining hours

    let FajrTimes = document.getElementById("Fajr-times");
    let SunriseTimes = document.getElementById("Sunrise-times");
    let DhuhrTimes = document.getElementById("Dhuhr-times");
    let AsrTimes = document.getElementById("Asr-times");
    let MaghribTimes = document.getElementById("Maghrib-times");
    let IshaTimes = document.getElementById("Isha-times");

    if (prayer === "Fajr") {
      FajrTimes.innerHTML = `  باقي  ${vhours}  ساعات و  ${vminutes} دقيقة  `;
    } else if (prayer === "Sunrise") {
      SunriseTimes.innerHTML = `   باقي  ${vhours}  ساعات و  ${vminutes} دقيقة  `;
    } else if (prayer === "Dhuhr") {
      DhuhrTimes.innerHTML = `   باقي  ${vhours}  ساعات و  ${vminutes} دقيقة  `;
    } else if (prayer === "Asr") {
      AsrTimes.innerHTML = `  باقي  ${vhours}  ساعات و  ${vminutes} دقيقة  `;
    } else if (prayer === "Maghrib") {
      MaghribTimes.innerHTML = `  باقي  ${vhours}  ساعات و  ${vminutes} دقيقة  `;
    } else if (prayer === "Isha") {
      IshaTimes.innerHTML = `  باقي  ${vhours}  ساعات و  ${vminutes} دقيقة  `;
    } else {
    }
  }
}

 
// add the country to the list of countries in Html
function getCountries() {
  for (country of allCountry.country) {
    let countryName = `
  <div class="countrybtn country cursor-pointer" data-country-id="${country.id}">
    <span>${country.name.ar}</span>
    <img class="flag" src="${country.img}" alt="country flag">
  </div>
  `;
    document.getElementById("allcountry").innerHTML += countryName;
  }
}
getCountries();

// add the city to the list of cities in Html depending on the country name
function getCities(countryID) {
 
  // Clear previous cities
  document.getElementById("allcities").innerHTML = "";

  let citiesName = "";
  for (city of allCountry.city) {
 
    if (city.cityID === countryID) {
      citiesName += `
      <div class="city" onclick="getcity('${city.ar}'); citySelected(this)">
        <span>${city.ar}</span>
      </div>
      `;

      document.getElementById("allcities").innerHTML = citiesName;
    }
  }
}
getCities(1);

// add click event listener to all country buttons given the country id to the city
let countryBtns = document.querySelectorAll(".countrybtn");
countryBtns.forEach((btn) => {
  btn.addEventListener("click", () => {
    let countryID = parseInt(btn.dataset.countryId);
     getCities(countryID);
  });
});

function getcity(ArabicCityName) {
  document.getElementById("city-head").innerHTML = ArabicCityName;
  document.getElementById("table-city").innerHTML = ArabicCityName;
  let cityName = "";
  let countryISO = "";
  for (let city of allCountry.city) {
    if (city.ar === ArabicCityName) {
      cityName = city.en;
      countryISO = city.ISO;
    }
  }
  getPrayTiming(cityName, countryISO);
}

// attach the card with brand with query parameter filter
function citySelected(el) {
  let selectedCity = document.getElementsByClassName('selected');
   for (element of selectedCity) {
    element.classList.remove('selected');
  }
  el.classList.add('selected');
}

// mobile menu buttons
let mobileMenu = document.getElementById('mobile-menu');
let mobileMenubtn = document.querySelector('.mobile-menu-btn');

mobileMenubtn.addEventListener('click', () => {
  mobileMenu.classList.toggle('hide');
  // mobileMenu.classList.remove('active');

});